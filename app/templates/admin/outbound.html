{% extends "admin/layout.html" %}

{% block title %}架電リスト - Premium Auto-Call Admin{% endblock %}

{% block content %}
<section id="tab-outbound" class="tab-content active">
    <div class="panel">
        <h2>架電実行マネージャー</h2>
        <div class="actions-bar"
            style="background: var(--glass); padding: 1.5rem; border-radius: 12px; border: 1px solid var(--panel-border);">
            <div class="form-group" style="margin-bottom: 0; flex: 1;">
                <label>適用シナリオ</label>
                <select id="outbound-scenario-select">
                    <option value="">未選択</option>
                </select>
            </div>
            <div style="display: flex; gap: 0.5rem; align-items: flex-end;">
                <input type="file" id="target-csv" accept=".csv" style="display:none" onchange="handleFileUpload(this)">
                <button class="secondary" onclick="document.getElementById('target-csv').click()">
                    <i class="fas fa-file-csv"></i> CSVインポート
                </button>
                <div
                    style="display: flex; background: rgba(255,255,255,0.05); padding: 0.3rem; border-radius: 8px; border: 1px solid var(--panel-border);">
                    <input type="text" id="manual-phone" placeholder="電話番号を手入力..."
                        style="background:transparent; border:none; color:white; padding: 0 0.5rem; width: 140px;"
                        onkeydown="if(event.key==='Enter') addTargetManually()">
                    <button class="primary small" onclick="addTargetManually()"
                        style="padding: 0.4rem 0.8rem; border-radius: 6px;">
                        追加
                    </button>
                </div>
                <button class="primary" onclick="startCalls()">
                    <i class="fas fa-play-circle"></i> 一斉架電開始
                </button>
                <button class="danger" onclick="stopAllCalls()" style="padding: 0.6rem 2rem;">
                    <i class="fas fa-stop-circle"></i> 強制停止
                </button>
            </div>
        </div>

        <div style="margin-top: 2rem;">
            <table id="targets-table">
                <thead>
                    <tr>
                        <th>対象電話番号</th>
                        <th>実行状態</th>
                        <th>インポート日時</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
</section>
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', () => {
        loadOutboundScenarios();
    });
</script>
{% endblock %}